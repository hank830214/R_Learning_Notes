price_2018_0102 <- read.csv("2330_price_2018_0102.csv", header = T)
rm(list = ls()
)
stock_2330 <- read.csv("2330_price_2018_0102.csv", header = T)
str(stock_2330)
price$date <- as.Date(price$date)
rm(list = ls())
price <- read.csv("2330_price_2018_0102.csv", header = T)
price$date <- as.Date(price$date)
color_vec <- ifelse(price$close > price$open, "red", "green")
date_label <- seq(as.Date("2017/1/1"), as.Date("2018/3/16"), by = "quarter")
View(price)
color_vec <- ifelse(price$close > price$open, "red", "green")
date_label <- seq(as.Date("2018/1/1"), as.Date("2018/2/28"), by = "month")
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = paste(goal_name, ": shares =", share_remain , "cost =", cost_avg), xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
par(mar = c(5,5,2,2))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
date_label <- seq(as.Date("2018/1/1"), as.Date("2018/2/28"), by = "month")
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
abline(h = mean(price$close), lty = 2)
points(x = trans_sub$date, y = trans_sub$price, pch = ifelse(trans_sub$share > 0, 24, 25), cex = 1, lwd = 2)
x <- 1:nrow(price)
price <- read.csv("2330_price_2018_0102.csv", header = T)
price$date <- as.Date(price$date)
color_vec <- ifelse(price$close > price$open, "red", "green")
x <- 1:nrow(price)
plot(x, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = x, y0 = price$low, x1 = x, y1 = price$high, col = color_vec, lwd = 1)
segments(x, y0 = price$open, x, y1 = price$close, col = color_vec, lwd = 4)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
abline(h = mean(price$close), lty = 2)
points(x = trans_sub$date, y = trans_sub$price, pch = ifelse(trans_sub$share > 0, 24, 25), cex = 1, lwd = 2)
color_vec <- ifelse(price$close > price$open, "red", "green")
x <- 1:nrow(price)
plot(x, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n")
segments(x, y0 = price$open, x, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = x, y0 = price$low, x1 = x, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
price <- read.csv("2330_price_2017.csv", header = T)
price$date <- as.Date(price$date)
color_vec <- ifelse(price$close > price$open, "red", "green")
x <- 1:nrow(price)
plot(x, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n")
segments(x, y0 = price$open, x, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = x, y0 = price$low, x1 = x, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
date_label <- price$date
x <- 1:nrow(price)
plot(x, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n")
segments(x, y0 = price$open, x, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = x, y0 = price$low, x1 = x, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
abline(h = mean(price$close), lty = 2)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
plot(x, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n")
segments(x, y0 = price$open, x, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = x, y0 = price$low, x1 = x, y1 = price$high, col = color_vec, lwd = 1)
axis(1, z, format(date_label, "%Y%m"), cex.axis = .7)
axis(1, x, format(date_label, "%Y%m"), cex.axis = .7)
abline(h = mean(price$close), lty = 2)
date_label <- seq(as.Date("2017/1/1"), as.Date("2017/12/31"), by = "quarter")
x <- 1:nrow(price)
plot(x, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n")
segments(x, y0 = price$open, x, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = x, y0 = price$low, x1 = x, y1 = price$high, col = color_vec, lwd = 1)
axis(1, which(price$date %in% date_label) , format(date_label, "%Y%m"), cex.axis = .7)
which(price$date %in% date_label)
date_label
price$date
which(price$date == "2017-01-01")
which(price$date == "2017-04-01")
which(price$date == "2017-07-01")
which(price$date == "2017-010-01")
which(price$date == "2017-10-01")
date_label
color_vec <- ifelse(price$close > price$open, "red", "green")
date_label <- seq(as.Date("2017/1/1"), as.Date("2017/12/31"), by = "quarter")
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n")
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
abline(h = mean(price$close), lty = 2)
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
abline(h = mean(price$close), lty = 2)
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
View(price)
price$volume <- celling(price$volume/1000)
price$volume <- ceiling(price$volume/1000)
View(price)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(min(price$volume), 2*max(price$volume)-min(price$volume)), lwd = 2)
abline(h = 0)
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(min(price$volume), 2*max(price$volume)-min(price$volume)), lwd = 2)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2*max(price$volume)), lwd = 2)
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2*max(price$volume)), lwd = 2)
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
par(new = T)
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
max(price$volume)
max(price$volume)/3
max(price$volume)/3
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = seq(0, max(price$volume), by = 50000), las = 1)
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = seq(0, max(price$volume), by = 50000), las = 1)
mtext(side = 4, line = 3, 'shares')
price <- read.csv("2330_price_2017.csv", header = T)
price$date <- as.Date(price$date)
price$volume <- ceiling(price$volume/1000)
color_vec <- ifelse(price$close > price$open, "red", "green")
date_label <- seq(as.Date("2017/1/1"), as.Date("2017/12/31"), by = "quarter")
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = seq(0, max(price$volume), by = 50000), las = 1)
mtext(side = 4, line = 3, 'volume')
seq(0, max(price$volume), by = 50000)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = seq(0, max(price$volume), by = 50000), las = 1)
seq(0, max(price$volume), by = 50000)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = seq(0, max(price$volume), by = 100000), las = 1)
axis(side = 4, at = seq(0, max(price$volume), by = 100000), labels = seq(0, max(price$volume), by = 100000), las = 1)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
axis(side = 4, at = seq(0, max(price$volume), by = 100000), labels = seq(0, max(price$volume), by = 100000), las = 1)
mtext(side = 4, line = 3, 'volume')
axis(side = 4, at = seq(0, max(price$volume), by = 100000), labels = seq(0, max(price$volume), by = 100000), las = 1)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = as.character(seq(0, max(price$volume), by = 50000)), las = 1)
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = as.character(seq(0, max(price$volume), by = 50000)), las = 1)
mtext(side = 4, line = 3, 'volume')
as.character(seq(0, max(price$volume), by = 50000))
as.character(seq(0, max(price$volume), by = 50000))
seq(0, max(price$volume), by = 50000)
as.character(seq(0, max(price$volume), by = 50000))
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = as.character(seq(0, max(price$volume), by = 50000), scipen = 999), las = 1)
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = as.character(seq(0, max(price$volume), by = 50000), scipen = 999), las = 1)
as.character(seq(0, max(price$volume), by = 50000), scipen = 999)
as.character(seq(0, max(price$volume), by = 50000), scipen = 999)
as.character(seq(0, max(price$volume), by = 50000), scipen = 999)
as.character(seq(0, max(price$volume), by = 50000), scipen = 999)
options(scipen=999)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = as.character(seq(0, max(price$volume), by = 50000), scipen = 999), las = 1)
getOption("scipen")
mtext(side = 4, line = 3, 'volume')
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
options(scipen=999)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = as.character(seq(0, max(price$volume), by = 50000), scipen = 999), las = 1)
getOption("scipen")
mtext(side = 4, line = 3, 'volume')
color_vec <- ifelse(price$close > price$open, "red", "green")
date_label <- seq(as.Date("2017/1/1"), as.Date("2017/12/31"), by = "quarter")
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
options(scipen=999)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = as.character(seq(0, max(price$volume), by = 50000), scipen = 999), las = 1)
getOption("scipen")
mtext(side = 4, line = 3, 'volume')
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "gray")
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "gray")
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "gray")
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "gray")
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "gray")
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "gray", border = NULL)
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
rect(par("usr")[1],par("usr")[3],par("usr")[2],par("usr")[4],col = "gray", border = NULL)
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", border = NULL)
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
par(mar = c(5,5,2,5))
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", border = NULL)
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", border = NULL)
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
par("usr")[1]
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", border = NULL)
?rect
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", lwd = 0)
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", lwd = 0)
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", lty = NULL)
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", border = F)
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", border = F)
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
color_vec <- ifelse(price$close > price$open, "white", "black")
date_label <- seq(as.Date("2017/1/1"), as.Date("2017/12/31"), by = "quarter")
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
rect(par("usr")[1], par("usr")[3], par("usr")[2], par("usr")[4], col = "gray", border = F)
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, lwd = 1)
color_vec <- ifelse(price$close > price$open, "red", "green")
date_label <- seq(as.Date("2017/1/1"), as.Date("2017/12/31"), by = "quarter")
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
options(scipen=999)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = as.character(seq(0, max(price$volume), by = 50000), scipen = 999), las = 1)
getOption("scipen")
mtext(side = 4, line = 3, 'volume')
price <- read.csv("2330_price_2017.csv", header = T)
price$date <- as.Date(price$date)
price$volume <- ceiling(price$volume/1000)
color_vec <- ifelse(price$close > price$open, "red", "green")
date_label <- seq(as.Date("2017/1/1"), as.Date("2017/12/31"), by = "quarter")
par(mar = c(5,5,2,5))
plot(x = price$date, y = price$open, main = "", xlab = "Date", ylab = "price",
type = "n", xaxt = "n", ylim = c(2*min(price$low) - max(price$high), max(price$high)))
segments(x0 = price$date, y0 = price$open, x1 = price$date, y1 = price$close, col = color_vec, lwd = 4)
segments(x0 = price$date, y0 = price$low, x1 = price$date, y1 = price$high, col = color_vec, lwd = 1)
axis(1, date_label, format(date_label, "%Y%m"), cex.axis = .7)
par(new = T)
plot(x = price$date, y = price$volume, type = "h", xaxt = "n", yaxt = "n", xlab = "", ylab = "", ylim = c(0, 2.5*max(price$volume)), lwd = 2)
options(scipen=999)
axis(side = 4, at = seq(0, max(price$volume), by = 50000), labels = as.character(seq(0, max(price$volume), by = 50000), scipen = 999), las = 1)
getOption("scipen")
mtext(side = 4, line = 3, 'volume')
